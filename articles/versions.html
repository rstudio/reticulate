<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Python Version Configuration • reticulate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Python Version Configuration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">reticulate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.44.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/arrays.html">Arrays in R and Python</a></li>
    <li><a class="dropdown-item" href="../articles/calling_python.html">Calling Python from R</a></li>
    <li><a class="dropdown-item" href="../articles/package.html">Using reticulate in an R Package</a></li>
    <li><a class="dropdown-item" href="../articles/python_dependencies.html">Managing an R Package's Python Dependencies</a></li>
    <li><a class="dropdown-item" href="../articles/python_packages.html">Installing Python Packages</a></li>
    <li><a class="dropdown-item" href="../articles/python_primer.html">Primer on Python for R Users</a></li>
    <li><a class="dropdown-item" href="../articles/r_markdown.html">R Markdown Python Engine</a></li>
    <li><a class="dropdown-item" href="../articles/rstudio_ide.html">RStudio IDE Tools for reticulate</a></li>
    <li><a class="dropdown-item" href="../articles/versions.html">Python Version Configuration</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/reticulate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Python Version Configuration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/reticulate/blob/main/vignettes/versions.Rmd" class="external-link"><code>vignettes/versions.Rmd</code></a></small>
      <div class="d-none name"><code>versions.Rmd</code></div>
    </div>

    
    
<div class="alert alert-info">
<blockquote>
<h2 id="updated-guidance"><strong>⚠ Updated Guidance</strong></h2>
<p>This vignette provides guidance for how to help reticulate discover
and use self-managed Python installations. This is generally no longer
necessary nor recommended beginning with Reticulate version 1.41.</p>
<p>We now recommend using <code><a href="../reference/py_require.html">py_require()</a></code> to declare Python
dependencies and leting reticulate automatically resolve
dependencies.</p>
<p>If you are attempting to use <code><a href="../reference/py_require.html">py_require()</a></code> but reticulate
is not resolving the correct environment, Consult the <a href="#order-of-discovery">Order Of Discovery</a> section below and
ensure no Python installations higher in the order of discovery are
present.</p>
<p>For example, if the <code>r-reticulate</code> virtualenv is being
discovered in favor of <code><a href="../reference/py_require.html">py_require()</a></code>’s ephemeral env, you
can remove it:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/virtualenv-tools.html">virtualenv_remove</a></span><span class="op">(</span><span class="st">"r-reticulate"</span><span class="op">)</span></span></code></pre></div>
<p>For more details, see the <code><a href="../reference/py_require.html">py_require()</a></code> docs and the <a href="python_packages.html">Installing Python Packages</a> vignette.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="locating-python">Locating Python<a class="anchor" aria-label="anchor" href="#locating-python"></a>
</h2>
<p>It is not uncommon for several installations of Python to be
available on a given system. The <strong>reticulate</strong> package can
bind to almost any Python installations, and provides a variety of
convenient ways to allow the user to implicitly or explicitly specify
which Python installation to select.</p>
<p>Note that for reticulate to bind to a version of Python it must have
been compiled with shared library support (i.e. with the
<code>--enable-shared</code> flag).</p>
<p>Consider the following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/py_eval.html">py_eval</a></span><span class="op">(</span><span class="st">"1+1"</span><span class="op">)</span></span></code></pre></div>
<p>In this case, reticulate will search for a suitable Python
installation. In the absence of other hints (detailed below), reticulate
will fallback to an environment named “r-reticulate”, creating it if
necessary.</p>
<p>Consider another case:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op">)</span></span>
<span><span class="va">scipy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"scipy"</span><span class="op">)</span></span>
<span><span class="va">scipy</span><span class="op">$</span><span class="fu">amin</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In this case, reticulate will first look for an environment named
“r-scipy”, and if that doesn’t exist, it will fallback to the
environment named “r-reticulate”.</p>
</div>
<div class="section level2">
<h2 id="providing-hints">Providing Hints<a class="anchor" aria-label="anchor" href="#providing-hints"></a>
</h2>
<p>There are a few ways you can provide hints as to which version of
Python should be used:</p>
<ol style="list-style-type: decimal">
<li><p>By setting the value of the <code>RETICULATE_PYTHON</code>
environment variable to a Python binary. Note that if you set this
environment variable, then the specified version of Python will always
be used (i.e. this is prescriptive rather than advisory). To set the
value of <code>RETICULATE_PYTHON</code>, insert
<code>Sys.setenv(RETICULATE_PYTHON = PATH)</code> into your project’s
.Rprofile, where <code>PATH</code> is your preferred Python
binary.</p></li>
<li><p>By calling one of the these functions:</p></li>
</ol>
<table class="table">
<colgroup>
<col width="26%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/use_python.html">use_python()</a></code></td>
<td>Specify the path a specific Python binary.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/use_python.html">use_virtualenv()</a></code></td>
<td>Specify the name of (or path to) a Python virtualenv.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/use_python.html">use_condaenv()</a></code></td>
<td>Specify the name of a Conda environment.</td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/use_python.html">use_python</a></span><span class="op">(</span><span class="st">"/usr/local/bin/python"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/use_python.html">use_virtualenv</a></span><span class="op">(</span><span class="st">"~/myenv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/use_python.html">use_condaenv</a></span><span class="op">(</span><span class="st">"myenv"</span><span class="op">)</span></span></code></pre></div>
<p>If the <code><a href="../reference/use_python.html">use_virtualenv()</a></code> function is supplied a name of a
virtual environment (as opposed to a path), it will look in the
virtualenv root directory, by default <code>~/.virtualenvs</code>, and
configurable by setting the environment variable
<code>WORKON_HOME</code>.</p>
<p>The <code><a href="../reference/use_python.html">use_condaenv()</a></code> function will use whatever conda
binary is found on the <code>PATH</code>. If you want to use a specific
alternate version you can use the <code>conda</code> parameter. For
example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/use_python.html">use_condaenv</a></span><span class="op">(</span>condaenv <span class="op">=</span> <span class="st">"r-nlp"</span>, conda <span class="op">=</span> <span class="st">"/opt/anaconda3/bin/conda"</span><span class="op">)</span></span></code></pre></div>
<p>Note that the <code>use_*()</code> functions take an optional
<code>required</code> argument. By default, a value of
<code>required = NULL</code> is equivalent to
<code>required = TRUE</code> in most circumstances. If
<code>required = FALSE</code> is supplied, then the call is considered
an optional hint as to where to find Python (i.e. it doesn’t produce an
error if the specified version doesn’t exist).</p>
</div>
<div class="section level2">
<h2 id="order-of-discovery">Order of Discovery<a class="anchor" aria-label="anchor" href="#order-of-discovery"></a>
</h2>
<p>The order in which Python installation will be discovered and used is
as follows:</p>
<ol style="list-style-type: decimal">
<li><p>If specified, the location referenced by the
<code>RETICULATE_PYTHON</code> environment variable. (Path to a Python
binary)</p></li>
<li><p>If specified, the location referenced by the
<code>RETICULATE_PYTHON_ENV</code> environment variable. (Path to or
name of a virtual environment or conda environment)</p></li>
<li><p>If specified, the location referenced by calls to
<code><a href="../reference/use_python.html">use_python()</a></code>, <code><a href="../reference/use_python.html">use_virtualenv()</a></code>, and
<code><a href="../reference/use_python.html">use_condaenv()</a></code> with <code>required = TRUE</code> (the
default).</p></li>
<li><p>If the environment variable
<code>RETICULATE_USE_MANAGED_VENV="yes"</code> is set, then reticulate
will use an ephemeral virtual environment that satisfies all the
requirements declared via <code><a href="../reference/py_require.html">py_require()</a></code></p></li>
<li><p>If the environment variable <code>VIRTUAL_ENV</code> is defined
(typically from running an <code>activate</code> script before R
started, or from having the “Automatically activate project-local Python
environments” option enabled in the RStudio IDE), then the Python from
the activated environment is used.</p></li>
<li><p>If the current working directory contains a pyproject.toml file
from a poetry environment, the Python installation from the poetry
environment is used.</p></li>
<li><p>If the current working directory contains a Pipfile associated
with a pipenv, the Python installation from pipenv is used.</p></li>
<li><p>If the current working directory contains a directory named
“venv”, “virtualenv”, “.venv”, or “.virtualenv”, and that directory is a
Python virtual environment, the Python from the virtual environment is
used.</p></li>
<li><p>If there was a call (typically from within a package using
reticulate), of the form:
<code>import("bar", delay_load = list(environment = "r-barlyr")</code>,
and there exists a virtual environment or conda environment named
<code>"r-barlyr"</code>, it is used.</p></li>
<li><p>If any call to <code><a href="../reference/use_python.html">use_python()</a></code>,
<code><a href="../reference/use_python.html">use_virtualenv()</a></code>, or <code><a href="../reference/use_python.html">use_condaenv()</a></code> was made
with <code>required = FALSE</code>, or from within a packages
<code>.onLoad()</code> function, and the referenced python installation
exists, it is used.</p></li>
<li><p>If there was a call to <code>import("bar")</code>, and there
exists a virtual environment or conda environment named
<code>"r-bar"</code>, it is used.</p></li>
<li><p>If specified, the location referenced by the
<code>RETICULATE_PYTHON_FALLBACK</code> environment variable. (Path to a
python binary)</p></li>
<li><p>If a virtual environment named <code>"r-reticulate"</code>
exists, it is used.</p></li>
<li><p>In the absence of any expression of preference via one of the
ways outlined above, reticulate falls back to resolving an ephemeral
virtual environment that satisfies all the requirement declared via
<code><a href="../reference/py_require.html">py_require()</a></code>. To disable this feature, you can set env var
<code>RETICULATE_USE_MANAGED_VENV="no"</code></p></li>
<li><p>If none of the above Python installations can be used, then we
fall back to using the Python on the <code>PATH</code>, or on Windows,
the Python referenced by the registry. If both <code>python</code> and
<code>python3</code> are on the <code>PATH</code>, then reticulate will
prefer <code>python3</code>, unless only <code>python</code> has NumPy
installed, or <code>python3</code> is built for a different architecture
than R (e.g., x86).</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="python-packages">Python Packages<a class="anchor" aria-label="anchor" href="#python-packages"></a>
</h2>
<p>You can learn more about installing Python packages into virtualenvs
or Conda environments in the article on <a href="python_packages.html">Installing Python Packages</a>.</p>
</div>
<div class="section level2">
<h2 id="configuration-info">Configuration Info<a class="anchor" aria-label="anchor" href="#configuration-info"></a>
</h2>
<p>You can use the <code><a href="../reference/py_config.html">py_config()</a></code> function to query for
information about the specific version of Python in use as well as a
list of other Python versions discovered on the system:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/py_config.html">py_config</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You can also use the <code><a href="../reference/py_discover_config.html">py_discover_config()</a></code> function to
see what version of Python will be used without actually loading
Python:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/py_discover_config.html">py_discover_config</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomasz Kalinowski, Kevin Ushey, JJ Allaire, RStudio, Yuan Tang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
